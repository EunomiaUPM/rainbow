{
  "openapi": "3.0.3",
  "info": {
    "title": "Rainbow Auth API",
    "description": "API for authentication and SSI management in the Rainbow project.",
    "version": "0.3.8",
    "contact": {
      "name": "Universidad Polit√©cnica de Madrid - UPM",
      "url": "https://www.upm.es/"
    }
  },
  "servers": [
    {
      "url": "/api/v1",
      "description": "API Gateway / Base Path"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": ["Health"],
        "summary": "Check service health",
        "responses": {
          "200": { "description": "Service is healthy" }
        }
      }
    },
    "/healthz": {
      "get": {
        "tags": ["Health"],
        "summary": "Check service health (k8s)",
        "responses": {
          "200": { "description": "Service is healthy" }
        }
      }
    },
    "/liveness": {
      "get": {
        "tags": ["Health"],
        "summary": "Check service liveness",
        "responses": {
          "200": { "description": "Service is alive" }
        }
      }
    },
    "/readiness": {
      "get": {
        "tags": ["Health"],
        "summary": "Check service readiness",
        "responses": {
          "200": { "description": "Service is ready" }
        }
      }
    },
    "/mates/all": {
      "get": {
        "tags": ["Mates"],
        "summary": "Get all known mates",
        "responses": {
          "200": {
            "description": "List of mates",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Mates" } }
              }
            }
          },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/mates/{id}": {
      "get": {
        "tags": ["Mates"],
        "summary": "Get mate by ID",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Mate found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Mates" }
              }
            }
          },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/mates/myself": {
      "get": {
        "tags": ["Mates"],
        "summary": "Get self information",
        "responses": {
          "200": {
            "description": "Self mate info",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Mates" }
              }
            }
          },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/mates/batch": {
      "post": {
        "tags": ["Mates"],
        "summary": "Get multiple mates by ID batch",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/BatchRequests" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "List of mates",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "$ref": "#/components/schemas/Mates" } }
              }
            }
          },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/mates/token": {
      "post": {
        "tags": ["Mates"],
        "summary": "Get mate by token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/VerifyTokenRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mate found",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Mates" }
              }
            }
          },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/vc-request/beg/cross-user": {
      "post": {
        "tags": ["VC Requester"],
        "summary": "Request VC via Cross-User interaction",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReachAuthority" }
            }
          }
        },
        "responses": {
          "200": { "description": "Request successful" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "412": { "$ref": "#/components/responses/PreconditionFailed" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/vc-request/beg/oidc": {
      "post": {
        "tags": ["VC Requester"],
        "summary": "Request VC via OIDC4VP interaction",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReachAuthority" }
            }
          }
        },
        "responses": {
          "200": { "description": "Request successful (may return a URI)" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "412": { "$ref": "#/components/responses/PreconditionFailed" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/gate/access": {
      "post": {
        "tags": ["GateKeeper"],
        "summary": "Manage access request",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/GrantRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Access response",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/GrantResponse" }
              }
            }
          },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "403": { "$ref": "#/components/responses/Forbidden" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/verifier/verify/{state}": {
      "post": {
        "tags": ["Verifier"],
        "summary": "Verify a presentation",
        "parameters": [
          { "name": "state", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": { "$ref": "#/components/schemas/VerifyPayload" }
            }
          }
        },
        "responses": {
          "200": { "description": "Verification result (may return redirect URI)" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "422": { "$ref": "#/components/responses/UnprocessableEntity" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/business/login": {
      "post": {
        "tags": ["Business"],
        "summary": "Login to business portal",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/RainbowBusinessLoginRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Login successful" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/onboard/provider": {
      "post": {
        "tags": ["Onboarding"],
        "summary": "Onboard a new provider",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ReachProvider" }
            }
          }
        },
        "responses": {
          "200": { "description": "Onboarding initiated (returns redirect URI)" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/vc-request/all": {
      "get": {
        "tags": ["VC Requester"],
        "summary": "Get all VC requests",
        "responses": {
          "200": {
            "description": "List of VC requests",
            "content": {
              "application/json": {
                "schema": { "type": "array", "items": { "type": "object" } }
              }
            }
          },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/vc-request/{id}": {
      "get": {
        "tags": ["VC Requester"],
        "summary": "Get VC request by ID",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "VC request details" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/vc-request/callback/{id}": {
      "get": {
        "tags": ["VC Requester"],
        "summary": "Process VC request callback (GET)",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "hash", "in": "query", "required": true, "schema": { "type": "string" } },
          {
            "name": "interact_ref",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "Callback processed" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "422": { "$ref": "#/components/responses/UnprocessableEntity" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      },
      "post": {
        "tags": ["VC Requester"],
        "summary": "Process VC request callback (POST)",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/CallbackBody" }
            }
          }
        },
        "responses": {
          "200": { "description": "Callback processed" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/onboard/callback/{id}": {
      "get": {
        "tags": ["Onboarding"],
        "summary": "Process onboarding callback (GET)",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "hash", "in": "query", "required": true, "schema": { "type": "string" } },
          {
            "name": "interact_ref",
            "in": "query",
            "required": true,
            "schema": { "type": "string" }
          }
        ],
        "responses": {
          "200": { "description": "Onboarding callback processed" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "422": { "$ref": "#/components/responses/UnprocessableEntity" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      },
      "post": {
        "tags": ["Onboarding"],
        "summary": "Process onboarding callback (POST)",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ApprovedCallbackBody" }
            }
          }
        },
        "responses": {
          "200": { "description": "Onboarding callback processed" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/gate/continue/{id}": {
      "post": {
        "tags": ["GateKeeper"],
        "summary": "Continue access request",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/RefBody" }
            }
          }
        },
        "responses": {
          "200": { "description": "Continuation response" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/verifier/pd/{state}": {
      "get": {
        "tags": ["Verifier"],
        "summary": "Get VP Definition",
        "parameters": [
          { "name": "state", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "VP Definition details" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/business/token": {
      "post": {
        "tags": ["Business"],
        "summary": "Get business token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/RainbowBusinessLoginRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Token response" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/gaia/.well-known/oauth-authorization-server": {
      "get": {
        "tags": ["Gaia Self-Issuer"],
        "summary": "Get OAuth Authorization Server metadata",
        "responses": {
          "200": { "description": "OAuth metadata" }
        }
      }
    },
    "/gaia/credential/generate": {
      "post": {
        "tags": ["Gaia Self-Issuer"],
        "summary": "Generate Gaia VCs",
        "responses": {
          "200": { "description": "Generation successful" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/gaia/credential/request": {
      "post": {
        "tags": ["Gaia Self-Issuer"],
        "summary": "Request Gaia VC",
        "responses": {
          "200": { "description": "VC request successful" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/register": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Register wallet",
        "responses": {
          "201": { "description": "Wallet registered" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/login": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Login to wallet",
        "responses": {
          "200": { "description": "Login successful" },
          "401": { "$ref": "#/components/responses/Unauthorized" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/logout": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Logout from wallet",
        "responses": {
          "200": { "description": "Logout successful" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/onboard": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Onboard wallet",
        "responses": {
          "201": { "description": "Onboarding successful" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/key": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Register new key",
        "responses": {
          "201": { "description": "Key registered" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      },
      "delete": {
        "tags": ["Wallet"],
        "summary": "Delete key",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/KeyDefinition" } }
          }
        },
        "responses": {
          "200": { "description": "Key deleted" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/did": {
      "get": {
        "tags": ["Wallet"],
        "summary": "Get wallet DID",
        "responses": {
          "200": { "description": "DID information" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      },
      "post": {
        "tags": ["Wallet"],
        "summary": "Register new DID",
        "responses": {
          "201": { "description": "DID registered" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      },
      "delete": {
        "tags": ["Wallet"],
        "summary": "Delete DID",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/DidsInfo" } }
          }
        },
        "responses": {
          "200": { "description": "DID deleted" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "404": { "$ref": "#/components/responses/NotFound" },
          "500": { "$ref": "#/components/responses/InternalServerError" }
        }
      }
    },
    "/wallet/did.json": {
      "get": {
        "tags": ["Wallet"],
        "summary": "Get DID Document",
        "responses": {
          "200": { "description": "DID Document (JSON)" }
        }
      }
    },
    "/wallet/info": {
      "get": {
        "tags": ["Wallet"],
        "summary": "Get wallet summary info",
        "responses": {
          "200": { "description": "Wallet info summary" }
        }
      }
    },
    "/wallet/vcs": {
      "get": {
        "tags": ["Wallet"],
        "summary": "Get wallet Verifiable Credentials",
        "responses": {
          "200": { "description": "List of credentials" }
        }
      }
    },
    "/wallet/oidc4vci": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Process OIDC4VCI request",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/OidcUri" } }
          }
        },
        "responses": {
          "200": { "description": "Request processed" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    },
    "/wallet/oidc4vp": {
      "post": {
        "tags": ["Wallet"],
        "summary": "Process OIDC4VP request",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/OidcUri" } }
          }
        },
        "responses": {
          "200": { "description": "Request processed (may redirect)" },
          "400": { "$ref": "#/components/responses/BadRequest" },
          "500": { "$ref": "#/components/responses/InternalServerError" },
          "502": { "$ref": "#/components/responses/BadGateway" }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "DidsInfo": {
        "type": "object",
        "properties": {
          "did": { "type": "string" },
          "method": { "type": "string" }
        }
      },
      "KeyDefinition": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "key_type": { "type": "string" }
        }
      },
      "OidcUri": {
        "type": "object",
        "required": ["uri"],
        "properties": {
          "uri": { "type": "string", "example": "openid-initiate-issuance://..." }
        }
      },
      "CallbackBody": {
        "oneOf": [
          { "$ref": "#/components/schemas/ApprovedCallbackBody" },
          { "$ref": "#/components/schemas/RejectedCallbackBody" }
        ]
      },
      "ApprovedCallbackBody": {
        "type": "object",
        "required": ["interact_ref", "hash"],
        "properties": {
          "interact_ref": { "type": "string" },
          "hash": { "type": "string" }
        }
      },
      "RejectedCallbackBody": {
        "type": "object",
        "required": ["rejected"],
        "properties": {
          "rejected": { "type": "string" }
        }
      },
      "RefBody": {
        "type": "object",
        "required": ["interact_ref"],
        "properties": {
          "interact_ref": { "type": "string" }
        }
      },
      "TokenRequest": {
        "type": "object",
        "required": ["grant_type", "pre-authorized_code"],
        "properties": {
          "grant_type": {
            "type": "string",
            "example": "urn:ietf:params:oauth:grant-type:pre-authorized_code"
          },
          "pre-authorized_code": { "type": "string" },
          "tx_code": { "type": "string", "nullable": true }
        }
      },
      "CredentialRequest": {
        "type": "object",
        "required": ["format", "proof", "credential_definition"],
        "properties": {
          "format": { "type": "string", "example": "jwt_vc_json" },
          "proof": {
            "type": "object",
            "properties": {
              "proof_type": { "type": "string", "example": "jwt" },
              "jwt": { "type": "string" }
            }
          },
          "credential_definition": {
            "type": "object",
            "properties": {
              "type": {
                "type": "array",
                "items": { "type": "string" },
                "example": ["VerifiableCredential", "IdentityCredential"]
              }
            }
          }
        }
      },
      "Mates": {
        "type": "object",
        "properties": {
          "participant_id": {
            "type": "string",
            "example": "urn:uuid:550e8400-e29b-41d4-a716-446655440000"
          },
          "participant_slug": { "type": "string", "example": "my-service" },
          "participant_type": { "type": "string", "example": "Provider" },
          "base_url": { "type": "string", "format": "uri", "nullable": true },
          "token": { "type": "string", "nullable": true },
          "token_actions": { "type": "string", "nullable": true },
          "saved_at": { "type": "string", "format": "date-time" },
          "last_interaction": { "type": "string", "format": "date-time" },
          "is_me": { "type": "boolean" }
        }
      },
      "BatchRequests": {
        "type": "object",
        "required": ["ids"],
        "properties": {
          "ids": {
            "type": "array",
            "items": { "type": "string" },
            "example": ["urn:uuid:...", "urn:uuid:..."]
          }
        }
      },
      "VerifyTokenRequest": {
        "type": "object",
        "required": ["token"],
        "properties": {
          "token": { "type": "string" }
        }
      },
      "ReachAuthority": {
        "type": "object",
        "required": ["id", "slug", "url", "vc_type"],
        "properties": {
          "id": { "type": "string" },
          "slug": { "type": "string" },
          "url": { "type": "string", "format": "uri" },
          "vc_type": { "type": "string" }
        },
        "example": {
          "id": "urn:uuid:...",
          "slug": "authority-1",
          "url": "https://auth.example.com",
          "vc_type": "VerifiableCredential"
        }
      },
      "ReachProvider": {
        "type": "object",
        "required": ["id", "slug", "url", "actions"],
        "properties": {
          "id": { "type": "string" },
          "slug": { "type": "string" },
          "url": { "type": "string", "format": "uri" },
          "actions": { "type": "string" }
        }
      },
      "GrantRequest": {
        "type": "object",
        "required": ["access_token", "client"],
        "properties": {
          "access_token": { "$ref": "#/components/schemas/AccessTokenRequirements" },
          "client": { "$ref": "#/components/schemas/ClientInfo" },
          "user": { "type": "string", "nullable": true },
          "interact": { "$ref": "#/components/schemas/InteractReq" }
        }
      },
      "AccessTokenRequirements": {
        "type": "object",
        "properties": {
          "access": {
            "type": "object",
            "properties": {
              "type": { "type": "string" },
              "actions": { "type": "array", "items": { "type": "string" } },
              "datatypes": { "type": "array", "items": { "type": "string" } }
            }
          },
          "label": { "type": "string" },
          "flags": { "type": "array", "items": { "type": "string" } }
        }
      },
      "ClientInfo": {
        "type": "object",
        "properties": {
          "key": {
            "type": "object",
            "properties": {
              "proof": { "type": "string" },
              "jwk": { "type": "object" }
            }
          }
        }
      },
      "InteractReq": {
        "type": "object",
        "properties": {
          "start": { "type": "array", "items": { "type": "string" } },
          "finish": {
            "type": "object",
            "properties": {
              "method": { "type": "string" },
              "uri": { "type": "string" },
              "nonce": { "type": "string" }
            }
          }
        }
      },
      "GrantResponse": {
        "type": "object",
        "properties": {
          "continue": {
            "type": "object",
            "properties": {
              "uri": { "type": "string" },
              "access_token": {
                "type": "object",
                "properties": {
                  "value": { "type": "string" }
                }
              }
            }
          },
          "interact": {
            "type": "object",
            "properties": {
              "redirect": { "type": "string" },
              "finish": { "type": "string" }
            }
          },
          "instance_id": { "type": "string" }
        }
      },
      "VerifyPayload": {
        "type": "object",
        "required": ["vp_token", "presentation_submission"],
        "properties": {
          "vp_token": { "type": "string" },
          "presentation_submission": { "type": "string" }
        }
      },
      "RainbowBusinessLoginRequest": {
        "type": "object",
        "required": ["authRequestId"],
        "properties": {
          "authRequestId": { "type": "string" }
        }
      },
      "ErrorInfo": {
        "type": "object",
        "properties": {
          "message": { "type": "string" },
          "error_code": { "type": "integer" },
          "details": { "type": "string", "nullable": true }
        }
      }
    },
    "responses": {
      "ErrorResponse": {
        "description": "Generic error response",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/ErrorInfo" }
          }
        }
      },
      "BadRequest": {
        "description": "Bad Request - Invalid payload or parameters",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "Unauthorized": {
        "description": "Unauthorized - Authentication failed",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "Forbidden": {
        "description": "Forbidden - Authorization failed",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "NotFound": {
        "description": "Not Found - Resource missing",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "PreconditionFailed": {
        "description": "Precondition Failed - Missing required action",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "UnprocessableEntity": {
        "description": "Unprocessable Entity - Security or validation error",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "InternalServerError": {
        "description": "Internal Server Error - System failure",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      },
      "BadGateway": {
        "description": "Bad Gateway - External service error",
        "content": {
          "application/json": { "schema": { "$ref": "#/components/schemas/ErrorInfo" } }
        }
      }
    }
  }
}
