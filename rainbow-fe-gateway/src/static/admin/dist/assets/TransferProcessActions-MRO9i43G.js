import{r as d,j as c,b as T}from"./ui-B_Y8HlyQ.js";import{G as p}from"./index-BIgPSPD9.js";import{h as m}from"./tanstack-CQsG9zHS.js";import{B as f,m as v}from"./infoItemMappers-DqPqlsKL.js";import{P as C,N as _}from"./ProcessActionDialog-DjaosBPO.js";const y=async e=>{let r=await(await fetch(e.api_gateway+"/transfers/rpc/setup-start",{headers:{"Content-Type":"application/json"},body:JSON.stringify(e.content),method:"POST"})).json();if(r.error)throw new Error(r.error);return{providerPid:r.providerPid}},g=()=>{const{data:e,isSuccess:r,isError:n,error:s,mutate:a,isPending:t,mutateAsync:i}=m({mutationFn:y,onMutate:async()=>{},onError:o=>{console.log("onError"),console.log(o)},onSuccess:async({},o)=>{console.log("onSuccess")},onSettled:()=>{}});return{data:e,isSuccess:r,isError:n,error:s,mutate:a,mutateAsync:i,isPending:t}},E=async e=>{let r=await(await fetch(e.api_gateway+"/transfers/rpc/setup-suspension",{headers:{"Content-Type":"application/json"},body:JSON.stringify(e.content),method:"POST"})).json();if(r.error)throw new Error(r.error);return{providerPid:r.providerPid}},w=()=>{const{data:e,isSuccess:r,isError:n,error:s,mutate:a,isPending:t,mutateAsync:i}=m({mutationFn:E,onMutate:async()=>{},onError:o=>{console.log("onError"),console.log(o)},onSuccess:async({},o)=>{console.log("onSuccess")},onSettled:()=>{}});return{data:e,isSuccess:r,isError:n,error:s,mutate:a,mutateAsync:i,isPending:t}},h=async e=>{let r=await(await fetch(e.api_gateway+"/transfers/rpc/setup-completion",{headers:{"Content-Type":"application/json"},body:JSON.stringify(e.content),method:"POST"})).json();if(r.error)throw new Error(r.error);return{providerPid:r.providerPid}},A=()=>{const{data:e,isSuccess:r,isError:n,error:s,mutate:a,isPending:t,mutateAsync:i}=m({mutationFn:h,onMutate:async()=>{},onError:o=>{console.log("onError"),console.log(o)},onSuccess:async({},o)=>{console.log("onSuccess")},onSettled:()=>{}});return{data:e,isSuccess:r,isError:n,error:s,mutate:a,mutateAsync:i,isPending:t}},D=async e=>{let r=await(await fetch(e.api_gateway+"/transfers/rpc/setup-termination",{headers:{"Content-Type":"application/json"},body:JSON.stringify(e.content),method:"POST"})).json();if(r.error)throw new Error(r.error);return{providerPid:r.providerPid}},x=()=>{const{data:e,isSuccess:r,isError:n,error:s,mutate:a,isPending:t,mutateAsync:i}=m({mutationFn:D,onMutate:async()=>{},onError:o=>{console.log("onError"),console.log(o)},onSuccess:async({},o)=>{console.log("onSuccess")},onSettled:()=>{}});return{data:e,isSuccess:r,isError:n,error:s,mutate:a,mutateAsync:i,isPending:t}},P=({process:e})=>{const{api_gateway:r,dsrole:n}=d.useContext(p),{mutateAsync:s}=g(),a=async()=>{const t=e;n==="provider"?await s({api_gateway:r,content:{consumerParticipantId:t.associated_consumer,consumerCallbackAddress:t.data_plane_id,consumerPid:t.consumer_pid,providerPid:t.provider_pid}}):n==="consumer"&&await s({api_gateway:r,content:{providerParticipantId:t.associated_provider,consumerPid:t.consumer_pid,providerPid:t.provider_pid}})};return c.jsx(f,{title:"Transfer Start Dialog",description:"You are about to start the transfer process.",infoItems:v(e,n),submitLabel:"Start",submitVariant:"default",onSubmit:a})},u=({process:e})=>{const{api_gateway:r,dsrole:n}=d.useContext(p),{mutateAsync:s}=x(),a=async()=>{const t=e;n==="provider"?await s({api_gateway:r,content:{consumerParticipantId:t.associated_consumer,consumerCallbackAddress:t.data_plane_id,consumerPid:t.consumer_pid,providerPid:t.provider_pid}}):n==="consumer"&&await s({api_gateway:r,content:{providerParticipantId:t.associated_provider,consumerPid:t.consumer_pid,providerPid:t.provider_pid}})};return c.jsx(f,{title:"Transfer Termination Dialog",description:"You are about to terminate the transfer process.",infoItems:v(e,n),submitLabel:"Terminate",submitVariant:"destructive",onSubmit:a})},b=({process:e})=>{const{api_gateway:r,dsrole:n}=d.useContext(p),{mutateAsync:s}=w(),a=async()=>{const t=e;n==="provider"?await s({api_gateway:r,content:{consumerParticipantId:t.associated_consumer,consumerCallbackAddress:t.data_plane_id,consumerPid:t.consumer_pid,providerPid:t.provider_pid}}):n==="consumer"&&await s({api_gateway:r,content:{providerParticipantId:t.associated_provider,consumerPid:t.consumer_pid,providerPid:t.provider_pid}})};return c.jsx(f,{title:"Transfer Suspension Dialog",description:"You are about to suspend the transfer process.",infoItems:v(e,n),submitLabel:"Suspend",submitVariant:"outline",onSubmit:a})},l=({process:e})=>{const{api_gateway:r,dsrole:n}=d.useContext(p),{mutateAsync:s}=A(),a=async()=>{const t=e;n==="provider"?await s({api_gateway:r,content:{consumerParticipantId:t.associated_consumer,consumerCallbackAddress:t.data_plane_id,consumerPid:t.consumer_pid,providerPid:t.provider_pid}}):n==="consumer"&&await s({api_gateway:r,content:{providerParticipantId:t.associated_provider,consumerPid:t.consumer_pid,providerPid:t.provider_pid}})};return c.jsx(f,{title:"Transfer Completion Dialog",description:"You are about to complete the transfer process.",infoItems:v(e,n),submitLabel:"Complete",submitVariant:"outline",onSubmit:a})},M=({process:e,tiny:r=!1})=>{const{dsrole:n}=d.useContext(p),s=T("",{variants:{tiny:{true:"inline-flex items-center ",false:"bg-background  w-full p-6 pt-4 fixed bottom-0 left-0 md:left-[223px] bg-primary-950/10 border border-t-stroke [&>*>button]:min-w-20"}}}),t=(()=>{if(n==="provider")switch(e.state){case"REQUESTED":return[{label:"Terminate",variant:"destructive",Component:u},{label:"Start",variant:"default",Component:P}];case"STARTED":return[{label:"Terminate",variant:"destructive",Component:u},{label:"Suspend",variant:"outline",Component:b},{label:"Complete",variant:"outline",Component:l}];case"SUSPENDED":const o=[{label:"Terminate",variant:"destructive",Component:u}];return e.stateAttribute&&e.stateAttribute!=="BY_CONSUMER"&&o.push({label:"Start",variant:"default",Component:P}),o.push({label:"Complete",variant:"outline",Component:l}),o;case"COMPLETED":case"TERMINATED":return[];default:return[]}else if(n==="consumer")switch(e.state){case"REQUESTED":return[{label:"Terminate",variant:"destructive",Component:u}];case"STARTED":return[{label:"Terminate",variant:"destructive",Component:u},{label:"Suspend",variant:"outline",Component:b},{label:"Complete",variant:"outline",Component:l}];case"SUSPENDED":const o=[{label:"Terminate",variant:"destructive",Component:u}];return e.stateAttribute&&e.stateAttribute!=="BY_PROVIDER"&&o.push({label:"Start",variant:"default",Component:P}),o.push({label:"Complete",variant:"outline",Component:l}),o;case"COMPLETED":case"TERMINATED":return[];default:return[]}return[]})(),i=()=>e.state==="COMPLETED"||e.state==="TERMINATED";return c.jsx("div",{className:s({tiny:r}),children:c.jsxs("div",{className:"space-x-2",children:[t.map((o,S)=>c.jsx(C,{label:o.label,variant:o.variant,tiny:r,DialogComponent:o.Component,process:e},S)),i()&&c.jsx(_,{})]})})};export{M as T};
