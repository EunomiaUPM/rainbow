import{r as p,j as e,B as d,a as x,I as q,n as I,N as ie,G as S,D as Y,F as z,o as M,p as R,s as O,t as T,v as V,S as ae,U as ne,V as te,W as le,X as re,Y as ce,w as de,x as g,y as b}from"./index-omH1oWRl.js";import{L as H,a as i,b as a}from"./list-cTQVuLal.js";import{a as X}from"./contract-queries-CDBcnN47.js";import{d as N}from"./dayjs.min-BAmgoTqK.js";import{H as $}from"./heading-BXPqTu4h.js";import{A as U,a as K,b as B,c as G,S as _,d as w,e as P,f as D,o as W,g as A,l as J,h as Q}from"./index-BFgWfo2C.js";import{P as F}from"./plus-C6EOZAEU.js";import{T as E}from"./trash-CtVCp9rW.js";import{N as L}from"./noFurtherActions-BBC3hgsu.js";const se=p.forwardRef(({policy:s},o)=>{const[h,v]=p.useState({obligation:[],permission:[],prohibition:[]});p.useImperativeHandle(o,()=>({getPolicy:()=>h})),p.useEffect(()=>{v({obligation:s.obligation||[],permission:s.permission||[],prohibition:s.prohibition||[]})},[s]);const C=t=>{const c={action:"",constraint:[]},l={...h};l[t].push(c),v(l)},y=(t,c)=>{const l={...h};l[t].splice(c,1),console.log(l),v(l)},u=(t,c)=>{const l={...h};l[t][c].constraint.push({leftOperand:"",operator:"",rightOperand:""}),v(l)},f=(t,c,l)=>{const m={...h};m[t][c].constraint.splice(l,1),v(m)},j=(t,c,l)=>{const m={...h};m[t][c].action=l,v(m)},n=(t,c,l,m,r)=>{const Z={...h};Z[t][c].constraint[l][m]=r,v(Z)};return e.jsx("div",{className:"w-full",children:e.jsxs(H,{className:" border border-white/30 bg-white/10 p-4 pt-2 rounded-md justify-start",children:[e.jsx("div",{className:"flex",children:e.jsxs($,{level:"h5",className:"flex gap-3",children:[e.jsx("div",{children:"Policy with ID"}),e.jsx(d,{variant:"info",className:"h-6",children:s["@id"].slice(9,29)+"[...]"})]})}),e.jsxs(i,{children:[e.jsx(a,{children:"Policy Target"}),e.jsx("p",{children:s["@type"]})]}),e.jsxs(i,{children:[e.jsx(a,{children:" Profile"}),e.jsxs("p",{className:"whitespace-normal",children:[" ",JSON.stringify(s.profile)]})]}),e.jsxs(i,{children:[e.jsx(a,{children:" Target"}),e.jsxs("p",{children:[" ",s.target.slice(9)]})]}),e.jsx("div",{className:"h-5"}),e.jsx($,{level:"h6",children:" ODRL CONTENT"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(U,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(K,{value:"item-1",className:"bg-success-500/10 border border-success-600/20",children:[e.jsx(B,{className:"text-white/70 flex bg-success-400/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"permission"})})}),e.jsxs(G,{className:"relative",children:[e.jsxs(x,{className:"border-b border-white/15",policy:"permission",variant:"outline",size:"xs",onClick:()=>C("permission"),children:[e.jsx(F,{}),"Add permission"]}),h.permission.map((t,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(x,{variant:"icon_destructive",size:"xs",className:"ml-4 border",onClick:()=>y("permission",c),children:[e.jsx(E,{className:"mb-0.5"}),"Remove permission"]})]}),e.jsxs(_,{onValueChange:l=>j("permission",c,l),value:t.action,children:[e.jsx(w,{className:"w-[240px]",children:e.jsx(P,{placeholder:"Select action"})}),e.jsx(D,{children:W.map(l=>e.jsx(A,{value:l,children:l},l))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),t.constraint.map((l,m)=>e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(_,{onValueChange:r=>n("permission",c,m,"leftOperand",r),value:l.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(w,{className:"w-[180px]",children:e.jsx(P,{placeholder:"Select item"})}),e.jsx(D,{children:J.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsx(_,{onValueChange:r=>n("permission",c,m,"operator",r),value:l.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(w,{className:"w-[140px]",children:e.jsx(P,{placeholder:"Select operator"})}),e.jsx(D,{children:Q.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(q,{placeholder:"Type value",value:l.rightOperand,onChange:r=>n("permission",c,m,"rightOperand",r.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(x,{variant:"icon_destructive",size:"icon",onClick:()=>f("permission",c,m),children:e.jsx(E,{className:"mb-0.5"})})})]})},m)),e.jsxs(x,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>u("permission",c),children:[e.jsx(F,{}),"Add constraint"]})]})},t.action))]})]})}),e.jsx(U,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(K,{value:"item-1",className:"bg-warn-500/10 border border-warn-600/20",children:[e.jsx(B,{className:"text-white/70 flex bg-warn-400/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"obligation"})})}),e.jsxs(G,{className:"relative",children:[e.jsxs(x,{className:"border-b border-white/15",policy:"obligation",variant:"outline",size:"xs",onClick:()=>C("obligation"),children:[e.jsx(F,{}),"Add obligation"]}),h.obligation.map((t,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(x,{variant:"icon_destructive",size:"xs",className:"ml-4",onClick:()=>y("obligation",c),children:[e.jsx(E,{className:"mb-0.5 text-danger"}),"Remove obligation"]})]}),e.jsxs(_,{onValueChange:l=>j("obligation",c,l),value:t.action,children:[e.jsx(w,{className:"w-[240px]",children:e.jsx(P,{placeholder:"Select action"})}),e.jsx(D,{children:W.map(l=>e.jsx(A,{value:l,children:l},l))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),t.constraint.map((l,m)=>e.jsx("div",{className:"flex flex-col gap-2 mb-[8px]",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(_,{onValueChange:r=>n("obligation",c,m,"leftOperand",r),value:l.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(w,{className:"w-[180px]",children:e.jsx(P,{placeholder:"Select item"})}),e.jsx(D,{children:J.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsx(_,{onValueChange:r=>n("obligation",c,m,"operator",r),value:l.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(w,{className:"w-[140px]",children:e.jsx(P,{placeholder:"Select operator"})}),e.jsx(D,{children:Q.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(q,{placeholder:"Type value",value:l.rightOperand,onChange:r=>n("obligation",c,m,"rightOperand",r.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(x,{variant:"icon_destructive",size:"icon",onClick:()=>f("obligation",c,m),children:e.jsx(E,{className:"mb-0.5"})})})]})},m)),e.jsxs(x,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>u("obligation",c),children:[e.jsx(F,{}),"Add constraint"]})]})},c))]})]})}),e.jsx(U,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(K,{value:"item-1",className:"bg-danger-500/10 border border-danger-600/20",children:[e.jsx(B,{className:"text-white/70 flex bg-danger-500/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"prohibition"})})}),e.jsxs(G,{className:"relative",children:[e.jsxs(x,{className:"border-b border-white/15",policy:"prohibition",variant:"outline",size:"xs",onClick:()=>C("prohibition"),children:[e.jsx(F,{}),"Add prohibition"]}),h.prohibition.map((t,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(x,{variant:"icon_destructive",size:"xs",className:"ml-4",onClick:()=>y("prohibition",c),children:[e.jsx(E,{className:"mb-0.5"}),"Remove prohibition"]})]}),e.jsxs(_,{onValueChange:l=>j("prohibition",c,l),value:t.action,children:[e.jsx(w,{className:"w-[240px]",children:e.jsx(P,{placeholder:"Select action"})}),e.jsx(D,{children:W.map(l=>e.jsx(A,{value:l,children:l},l))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),t.constraint.map((l,m)=>e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(_,{onValueChange:r=>n("prohibition",c,m,"leftOperand",r),value:l.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(w,{className:"w-[180px]",children:e.jsx(P,{placeholder:"Select item"})}),e.jsx(D,{children:J.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsx(_,{onValueChange:r=>n("prohibition",c,m,"operator",r),value:l.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(w,{className:"w-[140px]",children:e.jsx(P,{placeholder:"Select operator"})}),e.jsx(D,{children:Q.map(r=>e.jsx(A,{value:r,children:r},r))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(q,{placeholder:"Type value",value:l.rightOperand,onChange:r=>n("prohibition",c,m,"rightOperand",r.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(x,{variant:"icon_destructive",size:"icon",onClick:()=>f("prohibition",c,m),children:e.jsx(E,{className:"mb-0.5"})})})]})},m)),e.jsxs(x,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>u("prohibition",c),children:[e.jsx(F,{}),"Add constraint"]})]})},c))]})]})})]})})]})})}),oe=({process:s})=>{var n;const o=p.useRef(null),h=I(),{handleSubmit:v}=h,{mutateAsync:C}=ie(),{api_gateway:y}=p.useContext(S),{data:u}=X(s.provider_id),f=async()=>{if(o.current){const t=o.current.getPolicy(),c={...u==null?void 0:u.offer_content,prohibition:t.prohibition&&t.prohibition.length>0?t.prohibition:null,permission:t.permission&&t.permission.length>0?t.permission:null,obligation:t.obligation&&t.obligation.length>0?t.obligation:null};await C({api_gateway:y,content:{consumerParticipantId:s.associated_consumer,offer:c,consumerPid:s.consumer_id,providerPid:s.provider_id}})}},j="basis-[30%]";return e.jsx(Y,{className:"p-0",children:e.jsx(z,{...h,children:e.jsxs("form",{onSubmit:v(f),className:"space-y-6 flex flex-col h-fit max-h-[90dvh]",children:[e.jsxs(M,{className:"px-6 pt-6",children:[e.jsx(R,{children:"Contract Negotiation Offer"}),e.jsx(O,{children:e.jsx("p",{children:"Make changes on the Contract Negotiation Offer."})})]}),e.jsxs("div",{className:" overflow-y-scroll px-6",children:[e.jsxs(H,{className:"w-full  px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Associated Consumer:"}),e.jsx(d,{variant:"info",children:((n=s.associated_consumer)==null?void 0:n.slice(9,40))+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:j,children:"State:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Iniciated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Created at:"}),N(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{className:j,children:"Updated at:"}),N(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx("div",{className:"h-6"}),u&&e.jsx("div",{className:"flex w-full ",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"mb-2",children:"New policy request"}),e.jsx(se,{policy:u.offer_content,ref:o})]})})]}),e.jsxs(T,{className:"[&>*]:w-full p-6 pt-0",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",variant:"outline",children:"Counter offer"})]})]})})})},ee=({process:s})=>{var t;const o=I({}),{handleSubmit:h,control:v,setValue:C,getValues:y}=o,{mutateAsync:u}=ae(),{api_gateway:f}=p.useContext(S),j=()=>{u({api_gateway:f,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},n="basis-[33%]";return e.jsxs(Y,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Agreement dialog"}),e.jsx(O,{children:e.jsxs("span",{children:["You are about to agree to the terms of the contract negotiation.",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(H,{className:"min-w-full px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Consumer id:"}),e.jsx(d,{variant:"info",children:((t=s.associated_consumer)==null?void 0:t.slice(9,40))+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Current state:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Initiated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Created at:"}),e.jsxs("p",{children:[" ",N(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Updated at:"}),e.jsxs("p",{children:[" ",N(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(z,{...o,children:e.jsx("form",{onSubmit:h(j),className:"space-y-6",children:e.jsxs(T,{className:"[&>*]:w-full",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",children:"Agree"})]})})})]})},k=({process:s})=>{var c,l,m,r;const o=I({}),{handleSubmit:h,control:v,setValue:C,getValues:y}=o,{mutateAsync:u}=ne(),{api_gateway:f,dsrole:j}=p.useContext(S),n=()=>{j==="consumer"&&u({api_gateway:f,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}}),j==="provider"&&u({api_gateway:f,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},t="basis-[30%]";return e.jsxs(Y,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Termination dialog"}),e.jsx(O,{className:"max-w-full flex flex-wrap",children:e.jsxs("span",{className:"max-w-full flex flex-wrap",children:["You are about to terminate to the terms of the contract negotiation.",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(H,{className:"min-w-full px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Provider id:"}),e.jsx(d,{variant:"info",children:(c=s.provider_id)==null?void 0:c.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:(l=s.consumer_id)==null?void 0:l.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Associated Consumer:"}),e.jsx(d,{variant:"info",children:((m=s.associated_consumer)==null?void 0:m.slice(9,40))+"[...]"})]}),s.associated_provider&&e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Associated Provider:"}),e.jsx(d,{variant:"info",children:((r=s.associated_provider)==null?void 0:r.slice(9,40))+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:t,children:"State:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Iniciated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Created at:"}),N(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{className:t,children:"Updated at:"}),N(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx(z,{...o,children:e.jsx("form",{onSubmit:h(n),className:"space-y-6",children:e.jsxs(T,{className:"[&>*]:w-full",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",variant:"destructive",children:"Terminate"})]})})})]})},xe=({process:s})=>{const o=I({}),{handleSubmit:h,control:v,setValue:C,getValues:y}=o,{mutateAsync:u}=te(),{api_gateway:f}=p.useContext(S),j=()=>{u({api_gateway:f,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},n="basis-[33%]";return e.jsxs(Y,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Finalization dialog"}),e.jsx(O,{children:e.jsxs("p",{children:[" ","You are about to finalize to the terms of the contract negotiation. ",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(H,{className:"min-w-full px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Consumer id:"}),e.jsx(d,{variant:"info",children:s.associated_consumer.slice(9,40)+"[...]"})]}),s.associated_provider&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Provider id:"}),e.jsx(d,{variant:"info",children:s.associated_provider})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Current state:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Initiated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Created at:"}),e.jsxs("p",{children:[" ",N(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Updated at:"}),e.jsxs("p",{children:[" ",N(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(z,{...o,children:e.jsx("form",{onSubmit:h(j),className:"space-y-6",children:e.jsxs(T,{className:"[&>*]:w-full",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",children:"Finalize"})]})})})]})},he=({process:s})=>{const o=p.useRef(null),h=I(),{handleSubmit:v}=h,{mutateAsync:C}=le(),{api_gateway:y}=p.useContext(S),{data:u}=X(s.consumer_id),{data:f}=X(s.consumer_id),j=async()=>{if(o.current){const t=o.current.getPolicy(),c={...f.offer_content,prohibition:t.prohibition&&t.prohibition.length>0?t.prohibition:null,permission:t.permission&&t.permission.length>0?t.permission:null,obligation:t.obligation&&t.obligation.length>0?t.obligation:null};await C({api_gateway:y,content:{providerParticipantId:s.associated_provider,offer:c,consumerPid:s.consumer_id,providerPid:s.provider_id}})}},n="basis-[30%]";return e.jsx(Y,{className:"p-0   ",children:e.jsx(z,{...h,children:e.jsxs("form",{onSubmit:v(j),className:"space-y-6 flex flex-col h-fit max-h-[90dvh]",children:[e.jsxs(M,{className:"px-6 pt-6",children:[e.jsx(R,{children:"Contract Negotiation Request"}),e.jsx(O,{className:"break-all",children:e.jsx("p",{children:"Make changes on the Contract Negotiation Request."})})]}),e.jsxs("div",{className:" overflow-y-scroll px-6",children:[e.jsxs(H,{className:"w-fit  px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Consumer:"}),e.jsx(d,{variant:"info",children:s.associated_consumer.slice(9,-1)})]}),s.associated_provider&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Provider:"}),e.jsx(d,{variant:"info",children:s.associated_provider.slice(9,44)+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"State:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Iniciated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Created at:"}),N(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Updated at:"}),N(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx("div",{className:"h-6"}),u&&e.jsx("div",{className:"flex w-full ",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"mb-2",children:"New policy request"}),e.jsx(se,{policy:u.offer_content,ref:o})]})})]}),e.jsxs(T,{className:"[&>*]:w-full p-6 pt-0",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{variant:"outline",type:"submit",children:"Request"})]})]})})})},me=({process:s})=>{const o=I({}),{handleSubmit:h,control:v,setValue:C,getValues:y}=o,{mutateAsync:u}=re(),{api_gateway:f}=p.useContext(S),j=()=>{u({api_gateway:f,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}})},n="basis-[33%]";return e.jsxs(Y,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Acceptance dialog"}),e.jsx(O,{children:e.jsxs("span",{children:["You are about to accept the policy negotiation.",e.jsx("br",{})," Please review the details carefully before proceeding."]})})]}),e.jsxs(H,{className:"min-w-full px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9)})]}),s.associated_consumer&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Consumer id:"}),e.jsx(d,{variant:"info",children:s.associated_consumer.slice(9,40)+"[...]"})]}),s.associated_provider&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Provider id:"}),e.jsx(d,{variant:"info",children:s.associated_provider.slice(9,40)+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Current state:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Initiated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Created at:"}),e.jsxs("p",{children:[" ",N(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{children:"Updated at:"}),e.jsxs("p",{children:[" ",N(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(z,{...o,children:e.jsx("form",{onSubmit:h(j),className:"space-y-6",children:e.jsxs(T,{className:"[&>*]:w-full",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"outline",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",children:"Accept"})]})})})]})},je=({process:s})=>{const o=I({}),{handleSubmit:h,control:v,setValue:C,getValues:y}=o,{mutateAsync:u}=ce(),{api_gateway:f}=p.useContext(S),j=()=>{u({api_gateway:f,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}})},n="basis-[33%]";return e.jsxs(Y,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(M,{children:[e.jsx(R,{children:"Verification dialog"}),e.jsx(O,{children:e.jsxs("span",{children:["You are about to verify the agreement. ",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(H,{className:"min-w-full px-2",children:[e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Provider id:"}),e.jsx(d,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Consumer id:"}),e.jsx(d,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Consumer id:"}),e.jsx(d,{variant:"info",children:s.associated_consumer})]}),s.associated_provider&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Associated Provider id:"}),e.jsx(d,{variant:"info",children:s.associated_provider.slice(9,40)+"[...]"})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Current state:"}),e.jsx(d,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Initiated by:"}),e.jsx(d,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(i,{children:[e.jsx(a,{className:n,children:"Created at:"}),e.jsxs("p",{children:[" ",N(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(i,{children:[e.jsx(a,{children:"Updated at:"}),e.jsxs("p",{children:[" ",N(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(z,{...o,children:e.jsx("form",{onSubmit:h(j),className:"space-y-6",children:e.jsxs(T,{className:"[&>*]:w-full",children:[e.jsx(V,{asChild:!0,children:e.jsx(x,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(x,{type:"submit",children:"Verify"})]})})})]})},_e=({process:s,tiny:o=!1})=>{const{dsrole:h}=p.useContext(S),v=de("",{variants:{tiny:{true:"inline-flex items-center ",false:" w-full p-6 fixed bottom-0 left-0 md:left-[223px] bg-background/80 backdrop-blur-sm border border-t-stroke [&>*>button]:min-w-20"}}});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:v({tiny:o}),children:[s.state==="REQUESTED"&&e.jsxs("div",{className:"space-x-2 min-w-[260px]",children:[h==="provider"&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]}),e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"outline",size:o?"sm":"",children:"Counter offer"})}),e.jsx(oe,{process:s})]}),e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{size:o?"sm":"",children:"Agree"})}),e.jsx(ee,{process:s})]})]}),h==="consumer"&&e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]})]}),s.state==="OFFERED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[h==="provider"&&e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]}),h==="consumer"&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{size:o?"sm":"",children:"Accept"})}),e.jsx(me,{process:s})]}),e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"outline",size:o?"sm":"",children:"Counter request"})}),e.jsx(he,{process:s})]}),e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]})]})]}),s.state==="ACCEPTED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[h==="provider"&&e.jsx(e.Fragment,{children:e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{size:o?"sm":"",children:"Agree"})}),e.jsx(ee,{process:s})]})}),h==="consumer"&&e.jsx(e.Fragment,{children:e.jsx(L,{})})]}),s.state==="AGREED"&&e.jsxs("div",{className:"flex justify-start gap-2",children:[h==="provider"&&e.jsx(e.Fragment,{children:e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]})}),h==="consumer"&&e.jsx(e.Fragment,{children:e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{size:o?"sm":"",children:"Verify"})}),e.jsx(je,{process:s})]})})]}),s.state==="VERIFIED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[h==="provider"&&e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{size:o?"sm":"",children:"Finalize"})}),e.jsx(xe,{process:s})]}),e.jsxs(g,{children:[e.jsx(b,{asChild:!0,children:e.jsx(x,{variant:"destructive",size:o?"sm":"",children:"Terminate"})}),e.jsx(k,{process:s})]})]}),h==="consumer"&&e.jsx(e.Fragment,{children:e.jsx(L,{})})]}),s.state==="FINALIZED"&&e.jsx(L,{}),s.state==="TERMINATED"&&e.jsx(L,{})]})})};export{_e as C};
