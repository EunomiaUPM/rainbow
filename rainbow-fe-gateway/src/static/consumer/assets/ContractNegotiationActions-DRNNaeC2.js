import{a0 as Pe,r as N,a1 as ue,j as e,a2 as Ie,a3 as W,a4 as Re,a5 as Je,a6 as De,a7 as Ze,Q as w,K as pe,a8 as Xe,H as we,B as f,I as ce,i as z,a9 as es,G as M,D as V,F as Y,s as k,t as F,v as L,w as q,x as K,aa as ss,ab as is,ac as as,ad as ts,ae as ns,af as rs,M as ls,y,z as _}from"./index-BAHtZRt5.js";import{B as u}from"./badge-DhRbdQWa.js";import{L as T,a as r,b as l}from"./list-jggyKCr8.js";import{a as me}from"./contract-queries-Byw9ANgt.js";import{d as C}from"./dayjs.min-d0FxSukb.js";import{c as cs,u as os}from"./index-B9z-BDNq.js";import{S as I,a as R,b as D,c as S,d as O}from"./select-CWMeq0mN.js";import{P as $}from"./plus-_HvnKIbo.js";import{T as B}from"./trash-D768vGVp.js";import{N as Q}from"./noFurtherActions-yE6cfaSP.js";var se="Collapsible",[ds,Se]=Pe(se),[xs,fe]=ds(se),Oe=N.forwardRef((s,a)=>{const{__scopeCollapsible:i,open:d,defaultOpen:j,disabled:h,onOpenChange:m,...v}=s,[p,t]=ue({prop:d,defaultProp:j??!1,onChange:m,caller:se});return e.jsx(xs,{scope:i,disabled:h,contentId:Ie(),open:p,onOpenToggle:N.useCallback(()=>t(n=>!n),[t]),children:e.jsx(W.div,{"data-state":ge(p),"data-disabled":h?"":void 0,...v,ref:a})})});Oe.displayName=se;var Me="CollapsibleTrigger",Te=N.forwardRef((s,a)=>{const{__scopeCollapsible:i,...d}=s,j=fe(Me,i);return e.jsx(W.button,{type:"button","aria-controls":j.contentId,"aria-expanded":j.open||!1,"data-state":ge(j.open),"data-disabled":j.disabled?"":void 0,disabled:j.disabled,...d,ref:a,onClick:Re(s.onClick,j.onOpenToggle)})});Te.displayName=Me;var ve="CollapsibleContent",He=N.forwardRef((s,a)=>{const{forceMount:i,...d}=s,j=fe(ve,s.__scopeCollapsible);return e.jsx(Je,{present:i||j.open,children:({present:h})=>e.jsx(hs,{...d,ref:a,present:h})})});He.displayName=ve;var hs=N.forwardRef((s,a)=>{const{__scopeCollapsible:i,present:d,children:j,...h}=s,m=fe(ve,i),[v,p]=N.useState(d),t=N.useRef(null),n=De(a,t),c=N.useRef(0),o=c.current,g=N.useRef(0),x=g.current,P=m.open||v,H=N.useRef(P),E=N.useRef(void 0);return N.useEffect(()=>{const b=requestAnimationFrame(()=>H.current=!1);return()=>cancelAnimationFrame(b)},[]),Ze(()=>{const b=t.current;if(b){E.current=E.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const U=b.getBoundingClientRect();c.current=U.height,g.current=U.width,H.current||(b.style.transitionDuration=E.current.transitionDuration,b.style.animationName=E.current.animationName),p(d)}},[m.open,d]),e.jsx(W.div,{"data-state":ge(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!P,...h,ref:n,style:{"--radix-collapsible-content-height":o?`${o}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...s.style},children:P&&j})});function ge(s){return s?"open":"closed"}var ms=Oe,js=Te,us=He,A="Accordion",ps=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ne,fs,vs]=cs(A),[ie]=Pe(A,[vs,Se]),be=Se(),Ee=w.forwardRef((s,a)=>{const{type:i,...d}=s,j=d,h=d;return e.jsx(Ne.Provider,{scope:s.__scopeAccordion,children:i==="multiple"?e.jsx(Cs,{...h,ref:a}):e.jsx(bs,{...j,ref:a})})});Ee.displayName=A;var[ze,gs]=ie(A),[Ve,Ns]=ie(A,{collapsible:!1}),bs=w.forwardRef((s,a)=>{const{value:i,defaultValue:d,onValueChange:j=()=>{},collapsible:h=!1,...m}=s,[v,p]=ue({prop:i,defaultProp:d??"",onChange:j,caller:A});return e.jsx(ze,{scope:s.__scopeAccordion,value:w.useMemo(()=>v?[v]:[],[v]),onItemOpen:p,onItemClose:w.useCallback(()=>h&&p(""),[h,p]),children:e.jsx(Ve,{scope:s.__scopeAccordion,collapsible:h,children:e.jsx(Ye,{...m,ref:a})})})}),Cs=w.forwardRef((s,a)=>{const{value:i,defaultValue:d,onValueChange:j=()=>{},...h}=s,[m,v]=ue({prop:i,defaultProp:d??[],onChange:j,caller:A}),p=w.useCallback(n=>v((c=[])=>[...c,n]),[v]),t=w.useCallback(n=>v((c=[])=>c.filter(o=>o!==n)),[v]);return e.jsx(ze,{scope:s.__scopeAccordion,value:m,onItemOpen:p,onItemClose:t,children:e.jsx(Ve,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(Ye,{...h,ref:a})})})}),[ys,ae]=ie(A),Ye=w.forwardRef((s,a)=>{const{__scopeAccordion:i,disabled:d,dir:j,orientation:h="vertical",...m}=s,v=w.useRef(null),p=De(v,a),t=fs(i),c=os(j)==="ltr",o=Re(s.onKeyDown,g=>{var ye;if(!ps.includes(g.key))return;const x=g.target,P=t().filter(le=>{var _e;return!((_e=le.ref.current)!=null&&_e.disabled)}),H=P.findIndex(le=>le.ref.current===x),E=P.length;if(H===-1)return;g.preventDefault();let b=H;const U=0,te=E-1,ne=()=>{b=H+1,b>te&&(b=U)},re=()=>{b=H-1,b<U&&(b=te)};switch(g.key){case"Home":b=U;break;case"End":b=te;break;case"ArrowRight":h==="horizontal"&&(c?ne():re());break;case"ArrowDown":h==="vertical"&&ne();break;case"ArrowLeft":h==="horizontal"&&(c?re():ne());break;case"ArrowUp":h==="vertical"&&re();break}const Qe=b%E;(ye=P[Qe].ref.current)==null||ye.focus()});return e.jsx(ys,{scope:i,disabled:d,direction:j,orientation:h,children:e.jsx(Ne.Slot,{scope:i,children:e.jsx(W.div,{...m,"data-orientation":h,ref:p,onKeyDown:d?void 0:o})})})}),ee="AccordionItem",[_s,Ce]=ie(ee),ke=w.forwardRef((s,a)=>{const{__scopeAccordion:i,value:d,...j}=s,h=ae(ee,i),m=gs(ee,i),v=be(i),p=Ie(),t=d&&m.value.includes(d)||!1,n=h.disabled||s.disabled;return e.jsx(_s,{scope:i,open:t,disabled:n,triggerId:p,children:e.jsx(ms,{"data-orientation":h.orientation,"data-state":$e(t),...v,...j,ref:a,disabled:n,open:t,onOpenChange:c=>{c?m.onItemOpen(d):m.onItemClose(d)}})})});ke.displayName=ee;var Fe="AccordionHeader",Le=w.forwardRef((s,a)=>{const{__scopeAccordion:i,...d}=s,j=ae(A,i),h=Ce(Fe,i);return e.jsx(W.h3,{"data-orientation":j.orientation,"data-state":$e(h.open),"data-disabled":h.disabled?"":void 0,...d,ref:a})});Le.displayName=Fe;var je="AccordionTrigger",qe=w.forwardRef((s,a)=>{const{__scopeAccordion:i,...d}=s,j=ae(A,i),h=Ce(je,i),m=Ns(je,i),v=be(i);return e.jsx(Ne.ItemSlot,{scope:i,children:e.jsx(js,{"aria-disabled":h.open&&!m.collapsible||void 0,"data-orientation":j.orientation,id:h.triggerId,...v,...d,ref:a})})});qe.displayName=je;var Ke="AccordionContent",Ue=w.forwardRef((s,a)=>{const{__scopeAccordion:i,...d}=s,j=ae(A,i),h=Ce(Ke,i),m=be(i);return e.jsx(us,{role:"region","aria-labelledby":h.triggerId,"data-orientation":j.orientation,...m,...d,ref:a,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});Ue.displayName=Ke;function $e(s){return s?"open":"closed"}var ws=Ee,As=ke,Ps=Le,Be=qe,Ge=Ue;const oe=ws,J=N.forwardRef(({className:s,...a},i)=>e.jsx(As,{ref:i,className:pe("  text-white/80 rounded-md",s),...a}));J.displayName="AccordionItem";const Z=N.forwardRef(({className:s,children:a,...i},d)=>e.jsx(Ps,{className:"flex rounded-md ",children:e.jsxs(Be,{ref:d,className:pe("h-9 px-4 rounded-t-md font-bold flex flex-1 items-center justify-between py-1 text-sm font-medium transition-all text-left text-white/70 [&[data-state=open]>svg]:rotate-180",s),...i,children:[a,e.jsx(Xe,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Z.displayName=Be.displayName;const X=N.forwardRef(({className:s,children:a,...i},d)=>e.jsx(Ge,{ref:d,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...i,children:e.jsx("div",{className:pe("px-4 my-4 pt-0",s),children:a})}));X.displayName=Ge.displayName;const de=["read","analyze","share","ole","use","play","transfer","reproduce","distribute","display","print","execute","modify","extract","transform","delete","install","uninstall","present","obtain","give","derive","aggregate","disclose","inform","compensate","attribut","assign"],xe=["date","user","location","clara","dateTime","purpose","recipient","legalBasis","language","industry","spatial","elapsedTime","count","event","meter","version","hash"],he=["eq","neq","gt","lt","gteq","lteq","isA","isAnyOf","hasPart","isPartOf","isMemberOf","not","and","or","xone","andSequence"],We=N.forwardRef(({policy:s},a)=>{const[i,d]=N.useState({obligation:[],permission:[],prohibition:[]});N.useImperativeHandle(a,()=>({getPolicy:()=>i})),N.useEffect(()=>{d({obligation:s.obligation||[],permission:s.permission||[],prohibition:s.prohibition||[]})},[s]);const j=n=>{const c={action:"",constraint:[]},o={...i};o[n].push(c),d(o)},h=(n,c)=>{const o={...i};o[n].splice(c,1),console.log(o),d(o)},m=(n,c)=>{const o={...i};o[n][c].constraint.push({leftOperand:"",operator:"",rightOperand:""}),d(o)},v=(n,c,o)=>{const g={...i};g[n][c].constraint.splice(o,1),d(g)},p=(n,c,o)=>{const g={...i};g[n][c].action=o,d(g)},t=(n,c,o,g,x)=>{const P={...i};P[n][c].constraint[o][g]=x,d(P)};return e.jsx("div",{className:"w-full",children:e.jsxs(T,{className:" border border-white/30 bg-white/10 p-4 pt-2 rounded-md justify-start",children:[e.jsx("div",{className:"flex",children:e.jsxs(we,{level:"h5",className:"flex gap-3",children:[e.jsx("div",{children:"Policy with ID"}),e.jsx(u,{variant:"info",className:"h-6",children:s["@id"].slice(9,29)+"[...]"})]})}),e.jsxs(r,{children:[e.jsx(l,{children:"Policy Target"}),e.jsx("p",{children:s["@type"]})]}),e.jsxs(r,{children:[e.jsx(l,{children:" Profile"}),e.jsxs("p",{className:"whitespace-normal",children:[" ",JSON.stringify(s.profile)]})]}),e.jsxs(r,{children:[e.jsx(l,{children:" Target"}),e.jsxs("p",{children:[" ",s.target.slice(9)]})]}),e.jsx("div",{className:"h-5"}),e.jsx(we,{level:"h6",children:" ODRL CONTENT"}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(oe,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(J,{value:"item-1",className:"bg-success-500/10 border border-success-600/20",children:[e.jsx(Z,{className:"text-white/70 flex bg-success-400/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"permission"})})}),e.jsxs(X,{className:"relative",children:[e.jsxs(f,{className:"border-b border-white/15",policy:"permission",variant:"outline",size:"xs",onClick:()=>j("permission"),children:[e.jsx($,{}),"Add permission"]}),i.permission.map((n,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(f,{variant:"icon_destructive",size:"xs",className:"ml-4 border",onClick:()=>h("permission",c),children:[e.jsx(B,{className:"mb-0.5"}),"Remove permission"]})]}),e.jsxs(I,{onValueChange:o=>p("permission",c,o),value:n.action,children:[e.jsx(R,{className:"w-[240px]",children:e.jsx(D,{placeholder:"Select action"})}),e.jsx(S,{children:de.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),n.constraint.map((o,g)=>e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(I,{onValueChange:x=>t("permission",c,g,"leftOperand",x),value:o.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(R,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Select item"})}),e.jsx(S,{children:xe.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsx(I,{onValueChange:x=>t("permission",c,g,"operator",x),value:o.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(R,{className:"w-[140px]",children:e.jsx(D,{placeholder:"Select operator"})}),e.jsx(S,{children:he.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(ce,{placeholder:"Type value",value:o.rightOperand,onChange:x=>t("permission",c,g,"rightOperand",x.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(f,{variant:"icon_destructive",size:"icon",onClick:()=>v("permission",c,g),children:e.jsx(B,{className:"mb-0.5"})})})]})},g)),e.jsxs(f,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>m("permission",c),children:[e.jsx($,{}),"Add constraint"]})]})},n.action))]})]})}),e.jsx(oe,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(J,{value:"item-1",className:"bg-warn-500/10 border border-warn-600/20",children:[e.jsx(Z,{className:"text-white/70 flex bg-warn-400/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"obligation"})})}),e.jsxs(X,{className:"relative",children:[e.jsxs(f,{className:"border-b border-white/15",policy:"obligation",variant:"outline",size:"xs",onClick:()=>j("obligation"),children:[e.jsx($,{}),"Add obligation"]}),i.obligation.map((n,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(f,{variant:"icon_destructive",size:"xs",className:"ml-4",onClick:()=>h("obligation",c),children:[e.jsx(B,{className:"mb-0.5 text-danger"}),"Remove obligation"]})]}),e.jsxs(I,{onValueChange:o=>p("obligation",c,o),value:n.action,children:[e.jsx(R,{className:"w-[240px]",children:e.jsx(D,{placeholder:"Select action"})}),e.jsx(S,{children:de.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),n.constraint.map((o,g)=>e.jsx("div",{className:"flex flex-col gap-2 mb-[8px]",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(I,{onValueChange:x=>t("obligation",c,g,"leftOperand",x),value:o.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(R,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Select item"})}),e.jsx(S,{children:xe.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsx(I,{onValueChange:x=>t("obligation",c,g,"operator",x),value:o.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(R,{className:"w-[140px]",children:e.jsx(D,{placeholder:"Select operator"})}),e.jsx(S,{children:he.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(ce,{placeholder:"Type value",value:o.rightOperand,onChange:x=>t("obligation",c,g,"rightOperand",x.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(f,{variant:"icon_destructive",size:"icon",onClick:()=>v("obligation",c,g),children:e.jsx(B,{className:"mb-0.5"})})})]})},g)),e.jsxs(f,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>m("obligation",c),children:[e.jsx($,{}),"Add constraint"]})]})},c))]})]})}),e.jsx(oe,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(J,{value:"item-1",className:"bg-danger-500/10 border border-danger-600/20",children:[e.jsx(Z,{className:"text-white/70 flex bg-danger-500/25 uppercase overflow-hidden rounded-md data-[state=open]:rounded-b-none",children:e.jsx("div",{className:"flex items-center w-full",children:e.jsx("p",{className:"text-current",children:"prohibition"})})}),e.jsxs(X,{className:"relative",children:[e.jsxs(f,{className:"border-b border-white/15",policy:"prohibition",variant:"outline",size:"xs",onClick:()=>j("prohibition"),children:[e.jsx($,{}),"Add prohibition"]}),i.prohibition.map((n,c)=>e.jsx("div",{children:e.jsxs("div",{className:"policy-item-create",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"mb-2",children:" Action: "}),e.jsxs(f,{variant:"icon_destructive",size:"xs",className:"ml-4",onClick:()=>h("prohibition",c),children:[e.jsx(B,{className:"mb-0.5"}),"Remove prohibition"]})]}),e.jsxs(I,{onValueChange:o=>p("prohibition",c,o),value:n.action,children:[e.jsx(R,{className:"w-[240px]",children:e.jsx(D,{placeholder:"Select action"})}),e.jsx(S,{children:de.map(o=>e.jsx(O,{value:o,children:o},o))})]}),e.jsx("div",{className:"h-6"}),e.jsx("p",{className:"mb-2",children:" Constraints: "}),n.constraint.map((o,g)=>e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"constraint-create flex gap-3 items-end",children:[e.jsx(I,{onValueChange:x=>t("prohibition",c,g,"leftOperand",x),value:o.leftOperand,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Left Operand:"}),e.jsx(R,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Select item"})}),e.jsx(S,{children:xe.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsx(I,{onValueChange:x=>t("prohibition",c,g,"operator",x),value:o.operator,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Operator:"}),e.jsx(R,{className:"w-[140px]",children:e.jsx(D,{placeholder:"Select operator"})}),e.jsx(S,{children:he.map(x=>e.jsx(O,{value:x,children:x},x))})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Right Operand:"}),e.jsx(ce,{placeholder:"Type value",value:o.rightOperand,onChange:x=>t("prohibition",c,g,"rightOperand",x.currentTarget.value)})]}),e.jsx("div",{children:e.jsx(f,{variant:"icon_destructive",size:"icon",onClick:()=>v("prohibition",c,g),children:e.jsx(B,{className:"mb-0.5"})})})]})},g)),e.jsxs(f,{size:"xs",variant:"outline",className:"mt-3",onClick:()=>m("prohibition",c),children:[e.jsx($,{}),"Add constraint"]})]})},c))]})]})})]})})]})})}),Is=({process:s})=>{var t;const a=N.useRef(null),i=z(),{handleSubmit:d}=i,{mutateAsync:j}=es(),{api_gateway:h}=N.useContext(M),{data:m}=me(s.provider_id),v=async()=>{if(a.current){const n=a.current.getPolicy(),c={...m==null?void 0:m.offer_content,prohibition:n.prohibition&&n.prohibition.length>0?n.prohibition:null,permission:n.permission&&n.permission.length>0?n.permission:null,obligation:n.obligation&&n.obligation.length>0?n.obligation:null};await j({api_gateway:h,content:{consumerParticipantId:s.associated_consumer,offer:c,consumerPid:s.consumer_id,providerPid:s.provider_id}})}},p="basis-[30%]";return e.jsx(V,{className:"p-0",children:e.jsx(Y,{...i,children:e.jsxs("form",{onSubmit:d(v),className:"space-y-6 flex flex-col h-fit max-h-[90dvh]",children:[e.jsxs(k,{className:"px-6 pt-6",children:[e.jsx(F,{children:"Contract Negotiation Offer"}),e.jsx(L,{children:e.jsx("p",{children:"Make changes on the Contract Negotiation Offer."})})]}),e.jsxs("div",{className:" overflow-y-scroll px-6",children:[e.jsxs(T,{className:"w-full  px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Associated Consumer:"}),e.jsx(u,{variant:"info",children:((t=s.associated_consumer)==null?void 0:t.slice(9,40))+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:p,children:"State:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Iniciated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Created at:"}),C(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{className:p,children:"Updated at:"}),C(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx("div",{className:"h-6"}),m&&e.jsx("div",{className:"flex w-full ",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"mb-2",children:"New policy request"}),e.jsx(We,{policy:m.offer_content,ref:a})]})})]}),e.jsxs(q,{className:"[&>*]:w-full p-6 pt-0",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",variant:"outline",children:"Counter offer"})]})]})})})},Ae=({process:s})=>{var n;const a=z({}),{handleSubmit:i,control:d,setValue:j,getValues:h}=a,{mutateAsync:m}=ss(),{api_gateway:v}=N.useContext(M),p=()=>{m({api_gateway:v,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},t="basis-[33%]";return e.jsxs(V,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Agreement dialog"}),e.jsx(L,{children:e.jsxs("span",{children:["You are about to agree to the terms of the contract negotiation.",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(T,{className:"min-w-full px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Consumer id:"}),e.jsx(u,{variant:"info",children:((n=s.associated_consumer)==null?void 0:n.slice(9,40))+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Current state:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Initiated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Created at:"}),e.jsxs("p",{children:[" ",C(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Updated at:"}),e.jsxs("p",{children:[" ",C(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(Y,{...a,children:e.jsx("form",{onSubmit:i(p),className:"space-y-6",children:e.jsxs(q,{className:"[&>*]:w-full",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",children:"Agree"})]})})})]})},G=({process:s})=>{var c,o,g,x;const a=z({}),{handleSubmit:i,control:d,setValue:j,getValues:h}=a,{mutateAsync:m}=is(),{api_gateway:v,dsrole:p}=N.useContext(M),t=()=>{p==="consumer"&&m({api_gateway:v,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}}),p==="provider"&&m({api_gateway:v,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},n="basis-[30%]";return e.jsxs(V,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Termination dialog"}),e.jsx(L,{className:"max-w-full flex flex-wrap",children:e.jsxs("span",{className:"max-w-full flex flex-wrap",children:["You are about to terminate to the terms of the contract negotiation.",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(T,{className:"min-w-full px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Provider id:"}),e.jsx(u,{variant:"info",children:(c=s.provider_id)==null?void 0:c.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:(o=s.consumer_id)==null?void 0:o.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Associated Consumer:"}),e.jsx(u,{variant:"info",children:((g=s.associated_consumer)==null?void 0:g.slice(9,40))+"[...]"})]}),s.associated_provider&&e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Associated Provider:"}),e.jsx(u,{variant:"info",children:((x=s.associated_provider)==null?void 0:x.slice(9,40))+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:n,children:"State:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Iniciated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Created at:"}),C(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{className:n,children:"Updated at:"}),C(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx(Y,{...a,children:e.jsx("form",{onSubmit:i(t),className:"space-y-6",children:e.jsxs(q,{className:"[&>*]:w-full",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",variant:"destructive",children:"Terminate"})]})})})]})},Rs=({process:s})=>{const a=z({}),{handleSubmit:i,control:d,setValue:j,getValues:h}=a,{mutateAsync:m}=as(),{api_gateway:v}=N.useContext(M),p=()=>{m({api_gateway:v,content:{consumerParticipantId:s.associated_consumer,consumerPid:s.consumer_id,providerPid:s.provider_id}})},t="basis-[33%]";return e.jsxs(V,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Finalization dialog"}),e.jsx(L,{children:e.jsxs("p",{children:[" ","You are about to finalize to the terms of the contract negotiation. ",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(T,{className:"min-w-full px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Consumer id:"}),e.jsx(u,{variant:"info",children:s.associated_consumer.slice(9,40)+"[...]"})]}),s.associated_provider&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Provider id:"}),e.jsx(u,{variant:"info",children:s.associated_provider})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Current state:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Initiated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Created at:"}),e.jsxs("p",{children:[" ",C(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Updated at:"}),e.jsxs("p",{children:[" ",C(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(Y,{...a,children:e.jsx("form",{onSubmit:i(p),className:"space-y-6",children:e.jsxs(q,{className:"[&>*]:w-full",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",children:"Finalize"})]})})})]})},Ds=({process:s})=>{const a=N.useRef(null),i=z(),{handleSubmit:d}=i,{mutateAsync:j}=ts(),{api_gateway:h}=N.useContext(M),{data:m}=me(s.consumer_id),{data:v}=me(s.consumer_id),p=async()=>{if(a.current){const n=a.current.getPolicy(),c={...v.offer_content,prohibition:n.prohibition&&n.prohibition.length>0?n.prohibition:null,permission:n.permission&&n.permission.length>0?n.permission:null,obligation:n.obligation&&n.obligation.length>0?n.obligation:null};await j({api_gateway:h,content:{providerParticipantId:s.associated_provider,offer:c,consumerPid:s.consumer_id,providerPid:s.provider_id}})}},t="basis-[30%]";return e.jsx(V,{className:"p-0   ",children:e.jsx(Y,{...i,children:e.jsxs("form",{onSubmit:d(p),className:"space-y-6 flex flex-col h-fit max-h-[90dvh]",children:[e.jsxs(k,{className:"px-6 pt-6",children:[e.jsx(F,{children:"Contract Negotiation Request"}),e.jsx(L,{className:"break-all",children:e.jsx("p",{children:"Make changes on the Contract Negotiation Request."})})]}),e.jsxs("div",{className:" overflow-y-scroll px-6",children:[e.jsxs(T,{className:"w-fit  px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Consumer:"}),e.jsx(u,{variant:"info",children:s.associated_consumer.slice(9,-1)})]}),s.associated_provider&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Provider:"}),e.jsx(u,{variant:"info",children:s.associated_provider.slice(9,44)+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"State:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Iniciated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Created at:"}),C(s.created_at).format("DD/MM/YY HH:mm")]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Updated at:"}),C(s.updated_at).format("DD/MM/YY HH:mm")]})]}),e.jsx("div",{className:"h-6"}),m&&e.jsx("div",{className:"flex w-full ",children:e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"mb-2",children:"New policy request"}),e.jsx(We,{policy:m.offer_content,ref:a})]})})]}),e.jsxs(q,{className:"[&>*]:w-full p-6 pt-0",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{variant:"outline",type:"submit",children:"Request"})]})]})})})},Ss=({process:s})=>{const a=z({}),{handleSubmit:i,control:d,setValue:j,getValues:h}=a,{mutateAsync:m}=ns(),{api_gateway:v}=N.useContext(M),p=()=>{m({api_gateway:v,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}})},t="basis-[33%]";return e.jsxs(V,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Acceptance dialog"}),e.jsx(L,{children:e.jsxs("span",{children:["You are about to accept the policy negotiation.",e.jsx("br",{})," Please review the details carefully before proceeding."]})})]}),e.jsxs(T,{className:"min-w-full px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9)})]}),s.associated_consumer&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Consumer id:"}),e.jsx(u,{variant:"info",children:s.associated_consumer.slice(9,40)+"[...]"})]}),s.associated_provider&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Provider id:"}),e.jsx(u,{variant:"info",children:s.associated_provider.slice(9,40)+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Current state:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Initiated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Created at:"}),e.jsxs("p",{children:[" ",C(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{children:"Updated at:"}),e.jsxs("p",{children:[" ",C(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(Y,{...a,children:e.jsx("form",{onSubmit:i(p),className:"space-y-6",children:e.jsxs(q,{className:"[&>*]:w-full",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"outline",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",children:"Accept"})]})})})]})},Os=({process:s})=>{const a=z({}),{handleSubmit:i,control:d,setValue:j,getValues:h}=a,{mutateAsync:m}=rs(),{api_gateway:v}=N.useContext(M),p=()=>{m({api_gateway:v,content:{providerParticipantId:s.associated_provider,consumerPid:s.consumer_id,providerPid:s.provider_id}})},t="basis-[33%]";return e.jsxs(V,{className:"w-[70dvw] sm:max-w-fit",children:[e.jsxs(k,{children:[e.jsx(F,{children:"Verification dialog"}),e.jsx(L,{children:e.jsxs("span",{children:["You are about to verify the agreement. ",e.jsx("br",{}),"Please review the details carefully before proceeding."]})})]}),e.jsxs(T,{className:"min-w-full px-2",children:[e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Provider id:"}),e.jsx(u,{variant:"info",children:s.provider_id.slice(9,-1)})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Consumer id:"}),e.jsx(u,{variant:"info",children:s.consumer_id.slice(9,-1)})]}),s.associated_consumer&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Consumer id:"}),e.jsx(u,{variant:"info",children:s.associated_consumer})]}),s.associated_provider&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Associated Provider id:"}),e.jsx(u,{variant:"info",children:s.associated_provider.slice(9,40)+"[...]"})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Current state:"}),e.jsx(u,{variant:"status",state:s.state,children:s.state})]}),s.initiated_by&&e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Initiated by:"}),e.jsx(u,{variant:"role",role:s.initiated_by,children:s.initiated_by})]}),e.jsxs(r,{children:[e.jsx(l,{className:t,children:"Created at:"}),e.jsxs("p",{children:[" ",C(s.created_at).format("DD/MM/YY HH:mm")]})]}),s.updated_at&&e.jsxs(r,{children:[e.jsx(l,{children:"Updated at:"}),e.jsxs("p",{children:[" ",C(s.updated_at).format("DD/MM/YY HH:mm")]})]})]}),e.jsx(Y,{...a,children:e.jsx("form",{onSubmit:i(p),className:"space-y-6",children:e.jsxs(q,{className:"[&>*]:w-full",children:[e.jsx(K,{asChild:!0,children:e.jsx(f,{variant:"ghost",type:"reset",children:"Cancel"})}),e.jsx(f,{type:"submit",children:"Verify"})]})})})]})},qs=({process:s,tiny:a=!1})=>{const{dsrole:i}=N.useContext(M),d=ls("",{variants:{tiny:{true:"inline-flex items-center ",false:" w-full p-6 fixed bottom-0 left-0 md:left-[223px] bg-background/80 backdrop-blur-sm border border-t-stroke [&>*>button]:min-w-20"}}});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:d({tiny:a}),children:[s.state==="REQUESTED"&&e.jsxs("div",{className:"space-x-2 min-w-[260px]",children:[i==="provider"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]}),e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"outline",size:a?"sm":"",children:"Counter offer"})}),e.jsx(Is,{process:s})]}),e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{size:a?"sm":"",children:"Agree"})}),e.jsx(Ae,{process:s})]})]}),i==="consumer"&&e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]})]}),s.state==="OFFERED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[i==="provider"&&e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]}),i==="consumer"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{size:a?"sm":"",children:"Accept"})}),e.jsx(Ss,{process:s})]}),e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"outline",size:a?"sm":"",children:"Counter request"})}),e.jsx(Ds,{process:s})]}),e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]})]})]}),s.state==="ACCEPTED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[i==="provider"&&e.jsx(e.Fragment,{children:e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{size:a?"sm":"",children:"Agree"})}),e.jsx(Ae,{process:s})]})}),i==="consumer"&&e.jsx(e.Fragment,{children:e.jsx(Q,{})})]}),s.state==="AGREED"&&e.jsxs("div",{className:"flex justify-start gap-2",children:[i==="provider"&&e.jsx(e.Fragment,{children:e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]})}),i==="consumer"&&e.jsx(e.Fragment,{children:e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{size:a?"sm":"",children:"Verify"})}),e.jsx(Os,{process:s})]})})]}),s.state==="VERIFIED"&&e.jsxs("div",{className:"flex justify-end flex-row-reverse gap-2",children:[i==="provider"&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{size:a?"sm":"",children:"Finalize"})}),e.jsx(Rs,{process:s})]}),e.jsxs(y,{children:[e.jsx(_,{asChild:!0,children:e.jsx(f,{variant:"destructive",size:a?"sm":"",children:"Terminate"})}),e.jsx(G,{process:s})]})]}),i==="consumer"&&e.jsx(e.Fragment,{children:e.jsx(Q,{})})]}),s.state==="FINALIZED"&&e.jsx(Q,{}),s.state==="TERMINATED"&&e.jsx(Q,{})]})})};export{qs as C};
